<!-- API Integration Guide for ConferMeet Backend -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ConferMeet - API Integration Guide</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <style>
        code { background-color: #f5f5f5; padding: 2px 6px; border-radius: 3px; }
        pre { background-color: #f5f5f5; padding: 15px; border-radius: 5px; overflow-x: auto; }
    </style>
</head>
<body class="bg-light">
    <nav class="navbar navbar-dark bg-dark">
        <div class="container-fluid">
            <span class="navbar-brand mb-0 h1"><i class="bi bi-code-slash"></i> ConferMeet API Guide</span>
        </div>
    </nav>

    <div class="container my-5">
        <div class="card shadow-lg mb-5">
            <div class="card-body">
                <h1 class="mb-4">Backend API Integration Guide</h1>
                <p class="lead">Complete API documentation for connecting ConferMeet frontend to your backend server.</p>

                <!-- Authentication -->
                <h2 class="mt-5 mb-3">üîê Authentication</h2>
                <div class="alert alert-info">
                    <p><strong>All requests must include an Authorization header:</strong></p>
                    <code>Authorization: Bearer {TOKEN}</code>
                </div>

                <!-- API Endpoints -->
                <h2 class="mt-5 mb-3">üì° API Endpoints</h2>

                <!-- 1. Start Meeting -->
                <div class="card mb-4">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0"><code>POST /api/meetings/start</code> - Start New Meeting</h5>
                    </div>
                    <div class="card-body">
                        <p><strong>Description:</strong> Creates a new video conference meeting and returns meeting code.</p>
                        
                        <h6>Request Body:</h6>
                        <pre><code>{
  "hostName": "John Doe",
  "title": "Team Sync",
  "description": "Weekly team meeting",
  "maxParticipants": 50,
  "recordingEnabled": true,
  "chatEnabled": true
}</code></pre>

                        <h6>Response (200 OK):</h6>
                        <pre><code>{
  "success": true,
  "meetingCode": "abc-defg-hij",
  "meetingId": "meet_123456",
  "hostId": "user_789",
  "startTime": "2025-12-20T10:30:00Z",
  "expiresIn": 3600,
  "meetingLink": "https://yourdomain.com/meeting/abc-defg-hij"
}</code></pre>
                    </div>
                </div>

                <!-- 2. Join Meeting -->
                <div class="card mb-4">
                    <div class="card-header bg-success text-white">
                        <h5 class="mb-0"><code>POST /api/meetings/join</code> - Join Existing Meeting</h5>
                    </div>
                    <div class="card-body">
                        <p><strong>Description:</strong> Validates meeting code and adds participant to the meeting.</p>
                        
                        <h6>Request Body:</h6>
                        <pre><code>{
  "meetingCode": "abc-defg-hij",
  "participantName": "Jane Smith",
  "participantEmail": "jane@example.com",
  "joinWithAudio": true,
  "joinWithVideo": true
}</code></pre>

                        <h6>Response (200 OK):</h6>
                        <pre><code>{
  "success": true,
  "participantId": "part_456",
  "meetingId": "meet_123456",
  "isValid": true,
  "activeParticipants": 4,
  "maxParticipants": 50,
  "rtcConfiguration": {
    "iceServers": [
      {"urls": ["stun:stun.l.google.com:19302"]},
      {"urls": ["turn:turnserver.example.com"], "username": "user", "credential": "pass"}
    ]
  }
}</code></pre>

                        <h6>Error Response (400):</h6>
                        <pre><code>{
  "success": false,
  "error": "INVALID_MEETING_CODE",
  "message": "The meeting code is invalid or expired"
}</code></pre>
                    </div>
                </div>

                <!-- 3. Send Chat Message -->
                <div class="card mb-4">
                    <div class="card-header bg-info text-white">
                        <h5 class="mb-0"><code>POST /api/meetings/{meetingId}/messages</code> - Send Chat Message</h5>
                    </div>
                    <div class="card-body">
                        <p><strong>Description:</strong> Sends a chat message to all participants in the meeting.</p>
                        
                        <h6>Request Body:</h6>
                        <pre><code>{
  "participantId": "part_456",
  "participantName": "Jane Smith",
  "message": "Hey everyone, are you ready to start?",
  "timestamp": "2025-12-20T10:35:22Z"
}</code></pre>

                        <h6>Response (201 Created):</h6>
                        <pre><code>{
  "success": true,
  "messageId": "msg_789",
  "sentAt": "2025-12-20T10:35:22Z",
  "delivered": true
}</code></pre>
                    </div>
                </div>

                <!-- 4. Get Participants -->
                <div class="card mb-4">
                    <div class="card-header bg-warning text-dark">
                        <h5 class="mb-0"><code>GET /api/meetings/{meetingId}/participants</code> - Get Participant List</h5>
                    </div>
                    <div class="card-body">
                        <p><strong>Description:</strong> Retrieves list of all active participants in the meeting.</p>
                        
                        <h6>Response (200 OK):</h6>
                        <pre><code>{
  "success": true,
  "meetingId": "meet_123456",
  "participantCount": 4,
  "participants": [
    {
      "participantId": "part_123",
      "name": "John Doe",
      "email": "john@example.com",
      "joinedAt": "2025-12-20T10:30:00Z",
      "isHost": true,
      "audioEnabled": true,
      "videoEnabled": true,
      "handRaised": false
    },
    {
      "participantId": "part_456",
      "name": "Jane Smith",
      "email": "jane@example.com",
      "joinedAt": "2025-12-20T10:32:15Z",
      "isHost": false,
      "audioEnabled": true,
      "videoEnabled": false,
      "handRaised": true
    }
  ]
}</code></pre>
                    </div>
                </div>

                <!-- 5. End Meeting -->
                <div class="card mb-4">
                    <div class="card-header bg-danger text-white">
                        <h5 class="mb-0"><code>POST /api/meetings/{meetingId}/end</code> - End Meeting</h5>
                    </div>
                    <div class="card-body">
                        <p><strong>Description:</strong> Ends the meeting and disconnects all participants.</p>
                        
                        <h6>Request Body:</h6>
                        <pre><code>{
  "hostId": "user_789",
  "recordingFile": "recording_123.mp4",
  "meetingDuration": 1845
}</code></pre>

                        <h6>Response (200 OK):</h6>
                        <pre><code>{
  "success": true,
  "meetingId": "meet_123456",
  "endTime": "2025-12-20T11:00:45Z",
  "duration": 1845,
  "recordingId": "rec_999",
  "recordingUrl": "https://yourdomain.com/recordings/rec_999"
}</code></pre>
                    </div>
                </div>

                <!-- 6. Update Participant Status -->
                <div class="card mb-4">
                    <div class="card-header bg-secondary text-white">
                        <h5 class="mb-0"><code>PATCH /api/meetings/{meetingId}/participants/{participantId}</code> - Update Status</h5>
                    </div>
                    <div class="card-body">
                        <p><strong>Description:</strong> Updates participant's audio, video, or hand raise status.</p>
                        
                        <h6>Request Body:</h6>
                        <pre><code>{
  "audioEnabled": true,
  "videoEnabled": false,
  "handRaised": true,
  "status": "active"
}</code></pre>

                        <h6>Response (200 OK):</h6>
                        <pre><code>{
  "success": true,
  "participantId": "part_456",
  "updated": {
    "audioEnabled": true,
    "videoEnabled": false,
    "handRaised": true
  }
}</code></pre>
                    </div>
                </div>

                <!-- 7. WebSocket Events -->
                <h2 class="mt-5 mb-3">üîå WebSocket Real-Time Events</h2>
                <p>For real-time communication, connect to WebSocket and listen for these events:</p>

                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead class="table-dark">
                            <tr>
                                <th>Event</th>
                                <th>Payload</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>participant_joined</code></td>
                                <td>{ participantId, name, joinedAt }</td>
                                <td>New participant joins meeting</td>
                            </tr>
                            <tr>
                                <td><code>participant_left</code></td>
                                <td>{ participantId, name, leftAt }</td>
                                <td>Participant leaves meeting</td>
                            </tr>
                            <tr>
                                <td><code>chat_message</code></td>
                                <td>{ messageId, participantId, message, timestamp }</td>
                                <td>Chat message from participant</td>
                            </tr>
                            <tr>
                                <td><code>hand_raised</code></td>
                                <td>{ participantId, name }</td>
                                <td>Participant raises hand</td>
                            </tr>
                            <tr>
                                <td><code>hand_lowered</code></td>
                                <td>{ participantId, name }</td>
                                <td>Participant lowers hand</td>
                            </tr>
                            <tr>
                                <td><code>audio_toggled</code></td>
                                <td>{ participantId, enabled }</td>
                                <td>Audio muted/unmuted</td>
                            </tr>
                            <tr>
                                <td><code>video_toggled</code></td>
                                <td>{ participantId, enabled }</td>
                                <td>Video turned on/off</td>
                            </tr>
                            <tr>
                                <td><code>screen_shared</code></td>
                                <td>{ participantId, screenShareStream }</td>
                                <td>Screen sharing started</td>
                            </tr>
                            <tr>
                                <td><code>meeting_ended</code></td>
                                <td>{ meetingId, endTime }</td>
                                <td>Host ends the meeting</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Error Handling -->
                <h2 class="mt-5 mb-3">‚ùå Error Handling</h2>
                <div class="card">
                    <div class="card-body">
                        <h6>Standard Error Response:</h6>
                        <pre><code>{
  "success": false,
  "error": "ERROR_CODE",
  "message": "Human-readable error message",
  "statusCode": 400
}</code></pre>

                        <h6>Common Error Codes:</h6>
                        <ul>
                            <li><code>INVALID_TOKEN</code> - Authentication token is invalid or expired</li>
                            <li><code>INVALID_MEETING_CODE</code> - Meeting code doesn't exist or is expired</li>
                            <li><code>MEETING_FULL</code> - Maximum participants reached</li>
                            <li><code>MEETING_ENDED</code> - Meeting has already ended</li>
                            <li><code>UNAUTHORIZED</code> - User doesn't have permission</li>
                            <li><code>SERVER_ERROR</code> - Internal server error</li>
                        </ul>
                    </div>
                </div>

                <!-- Implementation Example -->
                <h2 class="mt-5 mb-3">üíª Implementation Example (JavaScript)</h2>
                <div class="card mb-4">
                    <div class="card-header bg-dark text-white">
                        <h6 class="mb-0">Start Meeting Example</h6>
                    </div>
                    <div class="card-body">
                        <pre><code class="language-javascript">// Start a new meeting
async function startMeeting(hostName, title) {
  try {
    const response = await fetch('/api/meetings/start', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${authToken}`
      },
      body: JSON.stringify({
        hostName: hostName,
        title: title,
        maxParticipants: 50,
        recordingEnabled: true
      })
    });

    const data = await response.json();
    
    if (data.success) {
      console.log('Meeting started:', data.meetingCode);
      // Redirect to meeting room
      window.location.href = `meeting.html?code=${data.meetingCode}`;
    } else {
      console.error('Error:', data.message);
    }
  } catch (error) {
    console.error('Request failed:', error);
  }
}</code></pre>
                    </div>
                </div>

                <div class="card mb-4">
                    <div class="card-header bg-dark text-white">
                        <h6 class="mb-0">Join Meeting Example</h6>
                    </div>
                    <div class="card-body">
                        <pre><code class="language-javascript">// Join existing meeting
async function joinMeeting(meetingCode, participantName) {
  try {
    const response = await fetch('/api/meetings/join', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${authToken}`
      },
      body: JSON.stringify({
        meetingCode: meetingCode,
        participantName: participantName,
        joinWithAudio: true,
        joinWithVideo: true
      })
    });

    const data = await response.json();
    
    if (data.success) {
      console.log('Joined meeting:', data.participantId);
      // Initialize WebRTC connection
      initializeWebRTC(data.rtcConfiguration);
    } else {
      alert('Failed to join meeting: ' + data.message);
    }
  } catch (error) {
    console.error('Request failed:', error);
  }
}</code></pre>
                    </div>
                </div>

                <!-- Security Guidelines -->
                <h2 class="mt-5 mb-3">üîí Security Guidelines</h2>
                <div class="alert alert-warning">
                    <ul>
                        <li><strong>Use HTTPS</strong> for all API calls</li>
                        <li><strong>Validate tokens</strong> on every request</li>
                        <li><strong>Use CORS</strong> carefully - whitelist domains</li>
                        <li><strong>Rate limit</strong> API endpoints to prevent abuse</li>
                        <li><strong>Encrypt</strong> sensitive data in transit and at rest</li>
                        <li><strong>Validate input</strong> on both frontend and backend</li>
                        <li><strong>Use strong passwords</strong> for admin accounts</li>
                        <li><strong>Implement 2FA</strong> for user accounts</li>
                    </ul>
                </div>

                <!-- Rate Limiting -->
                <h2 class="mt-5 mb-3">‚è±Ô∏è Rate Limiting</h2>
                <div class="card">
                    <div class="card-body">
                        <p><strong>Default rate limits per minute:</strong></p>
                        <ul>
                            <li>Start Meeting: 30 requests</li>
                            <li>Join Meeting: 100 requests</li>
                            <li>Send Message: 300 requests</li>
                            <li>Get Participants: 100 requests</li>
                        </ul>
                        <p class="text-muted mt-3">Rate limit headers included in response:</p>
                        <code>X-RateLimit-Limit: 100</code><br>
                        <code>X-RateLimit-Remaining: 95</code><br>
                        <code>X-RateLimit-Reset: 1703068500</code>
                    </div>
                </div>

                <!-- Testing -->
                <h2 class="mt-5 mb-3">üß™ Testing with cURL</h2>
                <div class="card">
                    <div class="card-body">
                        <h6>Start Meeting:</h6>
                        <pre><code>curl -X POST http://localhost:3000/api/meetings/start \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "hostName": "John Doe",
    "title": "Test Meeting"
  }'</code></pre>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-body">
                <h4>üìö Additional Resources</h4>
                <ul>
                    <li><a href="https://webrtc.org/" target="_blank">WebRTC Documentation</a></li>
                    <li><a href="https://socket.io/" target="_blank">Socket.io for Real-time Communication</a></li>
                    <li><a href="https://www.ietf.org/rfc/rfc7231.txt" target="_blank">HTTP/1.1 Specification</a></li>
                    <li><a href="https://developers.google.com/meet" target="_blank">Google Meet API</a></li>
                </ul>
            </div>
        </div>
    </div>

    <footer class="bg-dark text-white text-center py-4 mt-5">
        <p>&copy; 2025 ConferMeet - API Documentation | <a href="index.html" class="text-light">‚Üê Back to Home</a></p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
